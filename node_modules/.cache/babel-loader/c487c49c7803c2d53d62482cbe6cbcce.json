{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/Dep Trai/Projects/tueminhbookstore/src/components/Pages/Admin/AddPost.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport * as AdminActions from '../../../store/actions/adminActions';\nimport Paper from '@material-ui/core/Paper';\nimport { withFormik, Field, Form } from 'formik';\nimport { FormikTextField, FormikSelectField } from 'formik-material-fields';\nimport Button from '@material-ui/core/Button';\nimport SaveIcon from '@material-ui/icons/Save';\nimport ImageIcon from '@material-ui/icons/Image';\nimport { withRouter } from 'react-router-dom';\nimport * as Yup from 'yup';\nimport API from '../../../utils/api';\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\n/* global $ */\n\nconst styles = theme => ({\n  container: {\n    margin: theme.spacing(3),\n    display: 'flex',\n    flexDirection: 'row wrap',\n    width: '100%'\n  },\n  postImage: {\n    width: '100%'\n  },\n  Save: {\n    marginBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing()\n  },\n  leftSide: {\n    flex: 2,\n    height: '100%',\n    margin: theme.spacing(1),\n    padding: theme.spacing(3)\n  },\n  rightSide: {\n    flex: 1,\n    height: '100%',\n    margin: theme.spacing(1),\n    padding: theme.spacing(3)\n  }\n});\n\nclass AddPost extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.uploadImage = e => {\n      const data = new FormData();\n      data.append('file', e.target.files[0], new Date().getTime().toString() + e.target.files[0].name);\n      this.props.uploadImage(data, this.props.auth.token, this.props.admin.post.id, this.props.auth.user.userId);\n    };\n\n    this.modules = {\n      toolbar: [['bold', 'italic', 'underline', 'strike'], [{\n        'header': 1\n      }, {\n        'header': 2\n      }], [{\n        'list': 'ordered'\n      }, {\n        'list': 'bullet'\n      }], [{\n        'indent': '-1'\n      }, {\n        'indent': '+1'\n      }], [{\n        'size': ['small', 'medium', 'large', 'huge']\n      }], [{\n        'color': []\n      }, {\n        'background': []\n      }], ['image'], ['clean']]\n    };\n    this.formats = ['header', 'bold', 'italic', 'underline', 'strike', 'blockquote', 'script', ''];\n  }\n\n  componentDidUpdate(props, state) {\n    if (this.props.match.params.view === 'add' && this.props.admin.posts.filter(p => p.title === this.props.values.title)) {\n      new props.post.values();\n    }\n\n    if (this.props.admin.post.id !== props.admin.post.id) {\n      // when redux state changes post in admin reducer\n      this.props.setValues(this.props.admin.post);\n    }\n  }\n\n  componentDidMount(props, state) {\n    if (this.props.match.params.view === 'edit' && this.props.match.params.id) {\n      this.props.getSinglePost(this.props.match.params.id, this.props.auth.token);\n    }\n  }\n\n  render() {\n    const {\n      classes\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      className: classes.container,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Paper, {\n      className: classes.leftSide,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(FormikTextField, {\n      name: \"title\",\n      label: \"Title\",\n      margin: \"normal\",\n      onChange: e => this.props.setFieldValue('slug', e.target.value.toLowerCase().replace(/ /g, '_')),\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(FormikTextField, {\n      name: \"slug\",\n      label: \"Slug\",\n      margin: \"normal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(ReactQuill, {\n      value: this.props.values.content,\n      modules: this.modules,\n      formats: this.formats,\n      placeholder: \".....\",\n      onChange: val => this.props.setFieldValue('content', val),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(FormikTextField, {\n      name: \"content\",\n      label: \"Content\",\n      margin: \"normal\",\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(Paper, {\n      className: classes.rightSide,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(FormikSelectField, {\n      name: \"status\",\n      label: \"Status\",\n      margin: \"normal\",\n      options: [{\n        label: 'Unpublished',\n        value: false\n      }, {\n        label: 'Published',\n        value: true\n      }],\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.Save,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"secondary\",\n      onClick: e => {\n        this.props.handleSubmit();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(SaveIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 30\n      }\n    }), \"Save\")), this.props.admin.post.PostImage ? this.props.admin.post.PostImage.length > 0 ? /*#__PURE__*/React.createElement(\"img\", {\n      src: API.makeFileURL(this.props.admin.post.PostImage[0].url, this.props.auth.token),\n      className: classes.postImages,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 33\n      }\n    }) : null : null, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: e => {\n        $('.xxFile').trigger('click');\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(ImageIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 34\n      }\n    }), \"Upload\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      style: {\n        display: 'none'\n      },\n      className: \"xxFile\",\n      onChange: this.uploadImage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 29\n      }\n    })))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  auth: state.auth,\n  admin: state.admin\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addPost: (post, token) => {\n    dispatch(AdminActions.addPost(post, token));\n  },\n  updatePost: (post, token) => {\n    dispatch(AdminActions.updatePost(post, token));\n  },\n  getSinglePost: (id, token) => {\n    dispatch(AdminActions.getSinglePost(id, token));\n  },\n  uploadImage: (data, token, postId, userId) => {\n    dispatch(AdminActions.uploadImage(data, token, postId, userId));\n  }\n});\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(withFormik({\n  mapPropsToValues: props => ({\n    title: props.admin.post.title || '',\n    slug: props.admin.post.slug || '',\n    createdAt: props.admin.post.createdAt || '',\n    status: props.admin.post.status || false,\n    content: props.admin.post.content || ''\n  }),\n  validationSchema: Yup.object().shape({\n    title: Yup.string().required(),\n    slug: Yup.string().required(),\n    content: Yup.string().required()\n  }),\n  handleSubmit: (values, {\n    setSubmitting,\n    props\n  }) => {\n    console.log(\"Saving\", props.addPost);\n\n    if (props.match.params.view === 'edit') {\n      const post = { ...values,\n        id: props.match.params.id\n      };\n      props.updatePost(post, props.auth.token);\n    } else {\n      props.addPost(values, props.auth.token);\n    }\n  }\n})(withStyles(styles)(AddPost))));","map":{"version":3,"sources":["/mnt/c/Users/Dep Trai/Projects/tueminhbookstore/src/components/Pages/Admin/AddPost.js"],"names":["React","Component","connect","withStyles","AdminActions","Paper","withFormik","Field","Form","FormikTextField","FormikSelectField","Button","SaveIcon","ImageIcon","withRouter","Yup","API","ReactQuill","styles","theme","container","margin","spacing","display","flexDirection","width","postImage","Save","marginBottom","formControl","leftSide","flex","height","padding","rightSide","AddPost","uploadImage","e","data","FormData","append","target","files","Date","getTime","toString","name","props","auth","token","admin","post","id","user","userId","modules","toolbar","formats","componentDidUpdate","state","match","params","view","posts","filter","p","title","values","setValues","componentDidMount","getSinglePost","render","classes","setFieldValue","value","toLowerCase","replace","content","val","label","handleSubmit","PostImage","length","makeFileURL","url","postImages","$","trigger","mapStateToProps","mapDispatchToProps","dispatch","addPost","updatePost","postId","mapPropsToValues","slug","createdAt","status","validationSchema","object","shape","string","required","setSubmitting","console","log"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAAQC,OAAR,QAAsB,aAAtB;AACA,SAAQC,UAAR,QAAyB,0BAAzB;AACA,OAAO,KAAKC,YAAZ,MAA8B,qCAA9B;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AAEA,SAAQC,UAAR,EAAoBC,KAApB,EAA2BC,IAA3B,QAAsC,QAAtC;AACA,SAAQC,eAAR,EAAyBC,iBAAzB,QAAiD,wBAAjD;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,QAAP,MAAqB,yBAArB;AACA,OAAOC,SAAP,MAAsB,0BAAtB;AAEA,SAAQC,UAAR,QAAyB,kBAAzB;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AAEA,OAAOC,GAAP,MAAgB,oBAAhB;AAEA,OAAOC,UAAP,MAAuB,aAAvB;AACA,OAAO,iCAAP;AAEA;;AACA,MAAMC,MAAM,GAAGC,KAAK,KAAK;AACrBC,EAAAA,SAAS,EAAE;AACPC,IAAAA,MAAM,EAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CADD;AAEPC,IAAAA,OAAO,EAAE,MAFF;AAGPC,IAAAA,aAAa,EAAE,UAHR;AAIPC,IAAAA,KAAK,EAAE;AAJA,GADU;AAOrBC,EAAAA,SAAS,EAAE;AACPD,IAAAA,KAAK,EAAE;AADA,GAPU;AAUrBE,EAAAA,IAAI,EAAE;AACFC,IAAAA,YAAY,EAAET,KAAK,CAACG,OAAN,CAAc,CAAd;AADZ,GAVe;AAarBO,EAAAA,WAAW,EAAE;AACTR,IAAAA,MAAM,EAAEF,KAAK,CAACG,OAAN;AADC,GAbQ;AAgBrBQ,EAAAA,QAAQ,EAAE;AACNC,IAAAA,IAAI,EAAE,CADA;AAENC,IAAAA,MAAM,EAAE,MAFF;AAGNX,IAAAA,MAAM,EAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CAHF;AAINW,IAAAA,OAAO,EAAEd,KAAK,CAACG,OAAN,CAAc,CAAd;AAJH,GAhBW;AAsBrBY,EAAAA,SAAS,EAAE;AACPH,IAAAA,IAAI,EAAE,CADC;AAEPC,IAAAA,MAAM,EAAE,MAFD;AAGPX,IAAAA,MAAM,EAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CAHD;AAIPW,IAAAA,OAAO,EAAEd,KAAK,CAACG,OAAN,CAAc,CAAd;AAJF;AAtBU,CAAL,CAApB;;AA8BA,MAAMa,OAAN,SAAsBlC,SAAtB,CAAgC;AAAA;AAAA;;AAAA,SAe5BmC,WAf4B,GAebC,CAAD,IAAO;AACjB,YAAMC,IAAI,GAAG,IAAIC,QAAJ,EAAb;AACAD,MAAAA,IAAI,CAACE,MAAL,CAAY,MAAZ,EAAoBH,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,CAApB,EAAuC,IAAIC,IAAJ,GAAWC,OAAX,GAAqBC,QAArB,KAAkCR,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,EAAkBI,IAA3F;AACA,WAAKC,KAAL,CAAWX,WAAX,CAAuBE,IAAvB,EAA6B,KAAKS,KAAL,CAAWC,IAAX,CAAgBC,KAA7C,EAAoD,KAAKF,KAAL,CAAWG,KAAX,CAAiBC,IAAjB,CAAsBC,EAA1E,EAA8E,KAAKL,KAAL,CAAWC,IAAX,CAAgBK,IAAhB,CAAqBC,MAAnG;AACH,KAnB2B;;AAAA,SA2B5BC,OA3B4B,GA2BnB;AACLC,MAAAA,OAAO,EAAE,CACL,CAAC,MAAD,EAAS,QAAT,EAAmB,WAAnB,EAAgC,QAAhC,CADK,EAEL,CAAC;AAAC,kBAAU;AAAX,OAAD,EAAgB;AAAC,kBAAU;AAAX,OAAhB,CAFK,EAGL,CAAC;AAAC,gBAAQ;AAAT,OAAD,EAAsB;AAAC,gBAAQ;AAAT,OAAtB,CAHK,EAIL,CAAC;AAAC,kBAAU;AAAX,OAAD,EAAmB;AAAC,kBAAU;AAAX,OAAnB,CAJK,EAKL,CAAC;AAAC,gBAAQ,CAAC,OAAD,EAAU,QAAV,EAAoB,OAApB,EAA6B,MAA7B;AAAT,OAAD,CALK,EAML,CAAC;AAAC,iBAAS;AAAV,OAAD,EAAgB;AAAC,sBAAc;AAAf,OAAhB,CANK,EAOL,CAAC,OAAD,CAPK,EAQL,CAAC,OAAD,CARK;AADJ,KA3BmB;AAAA,SAwC5BC,OAxC4B,GAwClB,CACN,QADM,EAEN,MAFM,EAEE,QAFF,EAEY,WAFZ,EAEyB,QAFzB,EAEmC,YAFnC,EAEiD,QAFjD,EAE0D,EAF1D,CAxCkB;AAAA;;AAE5BC,EAAAA,kBAAkB,CAACX,KAAD,EAAQY,KAAR,EAAc;AAC5B,QAAG,KAAKZ,KAAL,CAAWa,KAAX,CAAiBC,MAAjB,CAAwBC,IAAxB,KAAiC,KAAjC,IAA0C,KAAKf,KAAL,CAAWG,KAAX,CAAiBa,KAAjB,CAAuBC,MAAvB,CAA8BC,CAAC,IAAIA,CAAC,CAACC,KAAF,KAAY,KAAKnB,KAAL,CAAWoB,MAAX,CAAkBD,KAAjE,CAA7C,EAAqH;AACjH,UAAInB,KAAK,CAACI,IAAN,CAAWgB,MAAf;AAEH;;AAED,QAAG,KAAKpB,KAAL,CAAWG,KAAX,CAAiBC,IAAjB,CAAsBC,EAAtB,KAA6BL,KAAK,CAACG,KAAN,CAAYC,IAAZ,CAAiBC,EAAjD,EAAoD;AAChD;AACA,WAAKL,KAAL,CAAWqB,SAAX,CAAqB,KAAKrB,KAAL,CAAWG,KAAX,CAAiBC,IAAtC;AAEH;AACJ;;AAQDkB,EAAAA,iBAAiB,CAACtB,KAAD,EAAQY,KAAR,EAAc;AAC3B,QAAG,KAAKZ,KAAL,CAAWa,KAAX,CAAiBC,MAAjB,CAAwBC,IAAxB,KAAiC,MAAjC,IAA2C,KAAKf,KAAL,CAAWa,KAAX,CAAiBC,MAAjB,CAAwBT,EAAtE,EAAyE;AACrE,WAAKL,KAAL,CAAWuB,aAAX,CAAyB,KAAKvB,KAAL,CAAWa,KAAX,CAAiBC,MAAjB,CAAwBT,EAAjD,EAAqD,KAAKL,KAAL,CAAWC,IAAX,CAAgBC,KAArE;AACH;AACJ;;AAoBDsB,EAAAA,MAAM,GAAE;AACJ,UAAM;AAACC,MAAAA;AAAD,QAAY,KAAKzB,KAAvB;AAEA,wBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEI,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAEyB,OAAO,CAACpD,SAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAEoD,OAAO,CAAC1C,QAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,eAAD;AACI,MAAA,IAAI,EAAC,OADT;AAEI,MAAA,KAAK,EAAC,OAFV;AAGI,MAAA,MAAM,EAAC,QAHX;AAII,MAAA,QAAQ,EAAEO,CAAC,IAAI,KAAKU,KAAL,CAAW0B,aAAX,CAAyB,MAAzB,EAAiCpC,CAAC,CAACI,MAAF,CAASiC,KAAT,CAAeC,WAAf,GAA6BC,OAA7B,CAAqC,IAArC,EAA2C,GAA3C,CAAjC,CAJnB;AAKI,MAAA,SAAS,MALb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAQI,oBAAC,eAAD;AACI,MAAA,IAAI,EAAC,MADT;AAEI,MAAA,KAAK,EAAC,MAFV;AAGI,MAAA,MAAM,EAAC,QAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARJ,eAaI,oBAAC,UAAD;AACI,MAAA,KAAK,EAAE,KAAK7B,KAAL,CAAWoB,MAAX,CAAkBU,OAD7B;AAEI,MAAA,OAAO,EAAE,KAAKtB,OAFlB;AAGI,MAAA,OAAO,EAAE,KAAKE,OAHlB;AAII,MAAA,WAAW,EAAC,OAJhB;AAKI,MAAA,QAAQ,EAAEqB,GAAG,IAAI,KAAK/B,KAAL,CAAW0B,aAAX,CAAyB,SAAzB,EAAoCK,GAApC,CALrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAbJ,eAoBI,oBAAC,eAAD;AACI,MAAA,IAAI,EAAC,SADT;AAEI,MAAA,KAAK,EAAC,SAFV;AAGI,MAAA,MAAM,EAAC,QAHX;AAII,MAAA,SAAS,MAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MApBJ,CADJ,eA4BI,oBAAC,KAAD;AAAO,MAAA,SAAS,EAAEN,OAAO,CAACtC,SAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,iBAAD;AACI,MAAA,IAAI,EAAC,QADT;AAEI,MAAA,KAAK,EAAC,QAFV;AAGI,MAAA,MAAM,EAAC,QAHX;AAII,MAAA,OAAO,EAAE,CACL;AAAC6C,QAAAA,KAAK,EAAE,aAAR;AAAuBL,QAAAA,KAAK,EAAE;AAA9B,OADK,EAEL;AAACK,QAAAA,KAAK,EAAE,WAAR;AAAqBL,QAAAA,KAAK,EAAE;AAA5B,OAFK,CAJb;AAQI,MAAA,SAAS,MARb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAWI;AAAK,MAAA,SAAS,EAAEF,OAAO,CAAC7C,IAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA,oBAAC,MAAD;AACI,MAAA,OAAO,EAAC,WADZ;AAEI,MAAA,KAAK,EAAC,WAFV;AAGI,MAAA,OAAO,EAAEU,CAAC,IAAI;AACV,aAAKU,KAAL,CAAWiC,YAAX;AACH,OALL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAMK,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANL,SADA,CAXJ,EAoBK,KAAKjC,KAAL,CAAWG,KAAX,CAAiBC,IAAjB,CAAsB8B,SAAtB,GACG,KAAKlC,KAAL,CAAWG,KAAX,CAAiBC,IAAjB,CAAsB8B,SAAtB,CAAgCC,MAAhC,GAAyC,CAAzC,gBACI;AAAK,MAAA,GAAG,EAAElE,GAAG,CAACmE,WAAJ,CAAgB,KAAKpC,KAAL,CAAWG,KAAX,CAAiBC,IAAjB,CAAsB8B,SAAtB,CAAgC,CAAhC,EAAmCG,GAAnD,EAAwD,KAAKrC,KAAL,CAAWC,IAAX,CAAgBC,KAAxE,CAAV;AAA0F,MAAA,SAAS,EAAEuB,OAAO,CAACa,UAA7G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,GAEC,IAHJ,GAIC,IAxBN,eAyBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,MAAD;AACI,MAAA,OAAO,EAAC,WADZ;AAEI,MAAA,KAAK,EAAC,SAFV;AAGI,MAAA,OAAO,EAAEhD,CAAC,IAAI;AACViD,QAAAA,CAAC,CAAC,SAAD,CAAD,CAAaC,OAAb,CAAqB,OAArB;AACH,OALL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAMK,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANL,WADJ,eAQI;AAAO,MAAA,IAAI,EAAC,MAAZ;AAAmB,MAAA,KAAK,EAAE;AAAChE,QAAAA,OAAO,EAAE;AAAV,OAA1B;AAA6C,MAAA,SAAS,EAAC,QAAvD;AAAgE,MAAA,QAAQ,EAAE,KAAKa,WAA/E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARJ,CAzBJ,CA5BJ,CAFJ,CADJ;AAuEH;;AAvH2B;;AA0HhC,MAAMoD,eAAe,GAAG7B,KAAK,KAAK;AAC9BX,EAAAA,IAAI,EAAEW,KAAK,CAACX,IADkB;AAE9BE,EAAAA,KAAK,EAAES,KAAK,CAACT;AAFiB,CAAL,CAA7B;;AAKA,MAAMuC,kBAAkB,GAAGC,QAAQ,KAAK;AACpCC,EAAAA,OAAO,EAAE,CAACxC,IAAD,EAAMF,KAAN,KAAgB;AACrByC,IAAAA,QAAQ,CAACtF,YAAY,CAACuF,OAAb,CAAqBxC,IAArB,EAA2BF,KAA3B,CAAD,CAAR;AACH,GAHmC;AAIpC2C,EAAAA,UAAU,EAAE,CAACzC,IAAD,EAAOF,KAAP,KAAiB;AACzByC,IAAAA,QAAQ,CAACtF,YAAY,CAACwF,UAAb,CAAwBzC,IAAxB,EAA8BF,KAA9B,CAAD,CAAR;AACH,GANmC;AAOpCqB,EAAAA,aAAa,EAAE,CAAClB,EAAD,EAAKH,KAAL,KAAe;AAC1ByC,IAAAA,QAAQ,CAACtF,YAAY,CAACkE,aAAb,CAA2BlB,EAA3B,EAA+BH,KAA/B,CAAD,CAAR;AACH,GATmC;AAUpCb,EAAAA,WAAW,EAAE,CAACE,IAAD,EAAOW,KAAP,EAAc4C,MAAd,EAAsBvC,MAAtB,KAAiC;AAC1CoC,IAAAA,QAAQ,CAACtF,YAAY,CAACgC,WAAb,CAAyBE,IAAzB,EAA+BW,KAA/B,EAAsC4C,MAAtC,EAA8CvC,MAA9C,CAAD,CAAR;AACH;AAZmC,CAAL,CAAnC;;AAeA,eAAexC,UAAU,CAACZ,OAAO,CAC7BsF,eAD6B,EAE7BC,kBAF6B,CAAP,CAGxBnF,UAAU,CAAC;AACTwF,EAAAA,gBAAgB,EAAG/C,KAAD,KAAY;AAC1BmB,IAAAA,KAAK,EAAEnB,KAAK,CAACG,KAAN,CAAYC,IAAZ,CAAiBe,KAAjB,IAA0B,EADP;AAE1B6B,IAAAA,IAAI,EAAEhD,KAAK,CAACG,KAAN,CAAYC,IAAZ,CAAiB4C,IAAjB,IAAyB,EAFL;AAG1BC,IAAAA,SAAS,EAAEjD,KAAK,CAACG,KAAN,CAAYC,IAAZ,CAAiB6C,SAAjB,IAA8B,EAHf;AAI1BC,IAAAA,MAAM,EAAElD,KAAK,CAACG,KAAN,CAAYC,IAAZ,CAAiB8C,MAAjB,IAA2B,KAJT;AAK1BpB,IAAAA,OAAO,EAAE9B,KAAK,CAACG,KAAN,CAAYC,IAAZ,CAAiB0B,OAAjB,IAA4B;AALX,GAAZ,CADT;AAQTqB,EAAAA,gBAAgB,EAAEnF,GAAG,CAACoF,MAAJ,GAAaC,KAAb,CAAmB;AACjClC,IAAAA,KAAK,EAAEnD,GAAG,CAACsF,MAAJ,GAAaC,QAAb,EAD0B;AAEjCP,IAAAA,IAAI,EAAEhF,GAAG,CAACsF,MAAJ,GAAaC,QAAb,EAF2B;AAGjCzB,IAAAA,OAAO,EAAE9D,GAAG,CAACsF,MAAJ,GAAaC,QAAb;AAHwB,GAAnB,CART;AAaTtB,EAAAA,YAAY,EAAE,CAACb,MAAD,EAAS;AAACoC,IAAAA,aAAD;AAAgBxD,IAAAA;AAAhB,GAAT,KAAoC;AAC9CyD,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB1D,KAAK,CAAC4C,OAA5B;;AACA,QAAG5C,KAAK,CAACa,KAAN,CAAYC,MAAZ,CAAmBC,IAAnB,KAA4B,MAA/B,EAAsC;AAClC,YAAMX,IAAI,GAAG,EACT,GAAGgB,MADM;AAETf,QAAAA,EAAE,EAAEL,KAAK,CAACa,KAAN,CAAYC,MAAZ,CAAmBT;AAFd,OAAb;AAIAL,MAAAA,KAAK,CAAC6C,UAAN,CAAiBzC,IAAjB,EAAuBJ,KAAK,CAACC,IAAN,CAAWC,KAAlC;AACH,KAND,MAMK;AACDF,MAAAA,KAAK,CAAC4C,OAAN,CAAcxB,MAAd,EAAsBpB,KAAK,CAACC,IAAN,CAAWC,KAAjC;AACH;AACJ;AAxBQ,CAAD,CAAV,CAyBC9C,UAAU,CAACe,MAAD,CAAV,CAAmBiB,OAAnB,CAzBD,CAHwB,CAAD,CAAzB","sourcesContent":["import React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport * as AdminActions from '../../../store/actions/adminActions';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\nimport {withFormik, Field, Form} from 'formik';\r\nimport {FormikTextField, FormikSelectField} from 'formik-material-fields';\r\nimport Button from '@material-ui/core/Button';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport ImageIcon from '@material-ui/icons/Image';\r\n\r\nimport {withRouter} from 'react-router-dom';\r\nimport * as Yup from 'yup';\r\n\r\nimport API from '../../../utils/api';\r\n\r\nimport ReactQuill from 'react-quill';\r\nimport 'react-quill/dist/quill.snow.css';\r\n\r\n/* global $ */\r\nconst styles = theme => ({\r\n    container: {\r\n        margin: theme.spacing(3),\r\n        display: 'flex',\r\n        flexDirection: 'row wrap',\r\n        width: '100%'\r\n    },\r\n    postImage: {\r\n        width: '100%'\r\n    },\r\n    Save: {\r\n        marginBottom: theme.spacing(2)\r\n    },\r\n    formControl: {\r\n        margin: theme.spacing()\r\n    },\r\n    leftSide: {\r\n        flex: 2,\r\n        height: '100%',\r\n        margin: theme.spacing(1),\r\n        padding: theme.spacing(3)\r\n    },\r\n    rightSide: {\r\n        flex: 1,\r\n        height: '100%',\r\n        margin: theme.spacing(1),\r\n        padding: theme.spacing(3)\r\n    }\r\n});\r\n\r\nclass AddPost extends Component {\r\n\r\n    componentDidUpdate(props, state){\r\n        if(this.props.match.params.view === 'add' && this.props.admin.posts.filter(p => p.title === this.props.values.title)){\r\n            new props.post.values;\r\n            \r\n        }\r\n\r\n        if(this.props.admin.post.id !== props.admin.post.id){\r\n            // when redux state changes post in admin reducer\r\n            this.props.setValues(this.props.admin.post);\r\n\r\n        }\r\n    }\r\n\r\n    uploadImage = (e) => {\r\n        const data = new FormData();\r\n        data.append('file', e.target.files[0], new Date().getTime().toString() + e.target.files[0].name);\r\n        this.props.uploadImage(data, this.props.auth.token, this.props.admin.post.id, this.props.auth.user.userId);\r\n    }\r\n\r\n    componentDidMount(props, state){\r\n        if(this.props.match.params.view === 'edit' && this.props.match.params.id){\r\n            this.props.getSinglePost(this.props.match.params.id, this.props.auth.token);\r\n        }\r\n    }\r\n\r\n    modules= {\r\n        toolbar: [\r\n            ['bold', 'italic', 'underline', 'strike'],\r\n            [{'header': 1}, {'header': 2}],\r\n            [{'list': 'ordered'}, {'list': 'bullet'}],\r\n            [{'indent': '-1'}, {'indent': '+1'}],\r\n            [{'size': ['small', 'medium', 'large', 'huge']}],\r\n            [{'color': []}, {'background': []}],\r\n            ['image'],\r\n            ['clean']\r\n        ]    \r\n    }\r\n\r\n    formats = [\r\n        'header',\r\n        'bold', 'italic', 'underline', 'strike', 'blockquote', 'script',''\r\n    ]\r\n\r\n    render(){\r\n        const {classes} = this.props;\r\n\r\n        return (\r\n            <div>\r\n                \r\n                <Form className={classes.container}>\r\n                    <Paper className={classes.leftSide}>\r\n                        <FormikTextField\r\n                            name=\"title\"\r\n                            label=\"Title\"\r\n                            margin=\"normal\"\r\n                            onChange={e => this.props.setFieldValue('slug', e.target.value.toLowerCase().replace(/ /g, '_'))}\r\n                            fullWidth\r\n                        />\r\n                        <FormikTextField\r\n                            name=\"slug\"\r\n                            label=\"Slug\"\r\n                            margin=\"normal\"\r\n                        />\r\n                        <ReactQuill\r\n                            value={this.props.values.content}\r\n                            modules={this.modules}\r\n                            formats={this.formats}\r\n                            placeholder=\".....\"\r\n                            onChange={val => this.props.setFieldValue('content', val)}\r\n                        />\r\n                        <FormikTextField\r\n                            name=\"content\"\r\n                            label=\"Content\"\r\n                            margin=\"normal\"\r\n                            fullWidth\r\n                        />\r\n                    </Paper>\r\n                    <Paper className={classes.rightSide}>\r\n                        <FormikSelectField \r\n                            name=\"status\"\r\n                            label=\"Status\"\r\n                            margin=\"normal\"\r\n                            options={[\r\n                                {label: 'Unpublished', value: false},\r\n                                {label: 'Published', value: true}\r\n                            ]}\r\n                            fullWidth\r\n                        />\r\n                        <div className={classes.Save}>\r\n                        <Button \r\n                            variant=\"contained\" \r\n                            color=\"secondary\"\r\n                            onClick={e => {\r\n                                this.props.handleSubmit();\r\n                            }}\r\n                            ><SaveIcon />Save</Button>\r\n                        </div>\r\n                        {this.props.admin.post.PostImage ?\r\n                            this.props.admin.post.PostImage.length > 0 ?\r\n                                <img src={API.makeFileURL(this.props.admin.post.PostImage[0].url, this.props.auth.token)} className={classes.postImages} />\r\n                            :null\r\n                        : null}\r\n                        <div>\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={e => {\r\n                                    $('.xxFile').trigger('click');\r\n                                }}\r\n                                ><ImageIcon />Upload</Button>\r\n                            <input type=\"file\" style={{display: 'none'}} className=\"xxFile\" onChange={this.uploadImage}/>\r\n                            \r\n                        </div>\r\n                    </Paper>\r\n                </Form>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    auth: state.auth,\r\n    admin: state.admin\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    addPost: (post,token) => {\r\n        dispatch(AdminActions.addPost(post, token));\r\n    },\r\n    updatePost: (post, token) => {\r\n        dispatch(AdminActions.updatePost(post, token));\r\n    },\r\n    getSinglePost: (id, token) => {\r\n        dispatch(AdminActions.getSinglePost(id, token));\r\n    },\r\n    uploadImage: (data, token, postId, userId) => {\r\n        dispatch(AdminActions.uploadImage(data, token, postId, userId))\r\n    }\r\n});\r\n\r\nexport default withRouter(connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(withFormik({\r\n    mapPropsToValues: (props) => ({\r\n        title: props.admin.post.title || '',\r\n        slug: props.admin.post.slug || '',\r\n        createdAt: props.admin.post.createdAt || '',\r\n        status: props.admin.post.status || false,\r\n        content: props.admin.post.content || ''\r\n    }),\r\n    validationSchema: Yup.object().shape({\r\n        title: Yup.string().required(),\r\n        slug: Yup.string().required(),\r\n        content: Yup.string().required()\r\n    }),\r\n    handleSubmit: (values, {setSubmitting, props}) => {\r\n        console.log(\"Saving\", props.addPost);\r\n        if(props.match.params.view === 'edit'){\r\n            const post = {\r\n                ...values,\r\n                id: props.match.params.id\r\n            }\r\n            props.updatePost(post, props.auth.token);\r\n        }else{\r\n            props.addPost(values, props.auth.token);\r\n        }\r\n    }\r\n})(withStyles(styles)(AddPost))));"]},"metadata":{},"sourceType":"module"}