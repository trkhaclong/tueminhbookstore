{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/Dep Trai/Projects/tueminhbookstore/src/components/Pages/Admin/AddProduct.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport * as AdminActions from '../../../store/actions/adminActions';\nimport Paper from '@material-ui/core/Paper';\nimport { withFormik, Field, Form } from 'formik';\nimport { FormikTextField, FormikSelectField } from 'formik-material-fields';\nimport Button from '@material-ui/core/Button';\nimport SaveIcon from '@material-ui/icons/Save';\nimport ImageIcon from '@material-ui/icons/Image';\nimport { withRouter } from 'react-router-dom';\nimport * as Yup from 'yup';\nimport API from '../../../utils/api';\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\n/* global $ */\n\nconst styles = theme => ({\n  container: {\n    margin: theme.spacing(3),\n    display: 'flex',\n    flexDirection: 'row wrap',\n    width: '100%'\n  },\n  productsImage: {\n    width: '100%'\n  },\n  Save: {\n    marginBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing()\n  },\n  leftSide: {\n    flex: 2,\n    height: '100%',\n    margin: theme.spacing(1),\n    padding: theme.spacing(3)\n  },\n  rightSide: {\n    flex: 1,\n    height: '100%',\n    margin: theme.spacing(1),\n    padding: theme.spacing(3)\n  }\n});\n\nclass AddProduct extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.uploadProductImage = e => {\n      const data = new FormData();\n      data.append('file', e.target.files[0], new Date().getTime().toString() + e.target.files[0].name);\n      this.props.uploadProductImage(data, this.props.auth.token, this.props.admin.product.id, this.props.auth.user.userId);\n    };\n\n    this.modules = {\n      toolbar: [['bold', 'italic', 'underline', 'strike'], [{\n        'header': 1\n      }, {\n        'header': 2\n      }], [{\n        'list': 'ordered'\n      }, {\n        'list': 'bullet'\n      }], [{\n        'indent': '-1'\n      }, {\n        'indent': '+1'\n      }], [{\n        'size': ['small', 'medium', 'large', 'huge']\n      }], [{\n        'color': []\n      }, {\n        'background': []\n      }], ['image'], ['clean']]\n    };\n    this.formats = ['header', 'bold', 'italic', 'underline', 'strike', 'blockquote', 'script', ''];\n  }\n\n  componentDidUpdate(props, state) {\n    if (this.props.match.params.view === 'add' && this.props.admin.products.filter(p => p.title === this.props.values.title).length > 0) {\n      const product = this.props.admin.products.filter(p => p.title === this.props.values.title)[0];\n      this.props.history.push('/admin/products/edit/' + product.dispatch);\n    }\n\n    if (this.props.admin.product.id !== props.admin.product.id) {\n      // when redux state changes product in admin reducer\n      this.props.setValues(this.props.admin.product);\n    }\n  }\n\n  componentDidMount(props, state) {\n    if (this.props.match.params.view === 'edit' && this.props.match.params.id) {\n      this.props.getSingleProduct(this.props.match.params.id, this.props.auth.token);\n    }\n  }\n\n  render() {\n    const {\n      classes\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      className: classes.container,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Paper, {\n      className: classes.leftSide,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(FormikTextField, {\n      name: \"name\",\n      label: \"Name\",\n      margin: \"normal\",\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(FormikTextField, {\n      name: \"supplier\",\n      label: \"Supplier\",\n      margin: \"normal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(FormikTextField, {\n      name: \"author\",\n      label: \"Author\",\n      margin: \"normal\",\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(FormikTextField, {\n      name: \"publishing\",\n      label: \"Publishing\",\n      margin: \"normal\",\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(ReactQuill, {\n      value: this.props.values.content,\n      modules: this.modules,\n      formats: this.formats,\n      placeholder: \".....\",\n      onChange: val => this.props.setFieldValue('description', val),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(Paper, {\n      className: classes.rightSide,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(FormikSelectField, {\n      name: \"inventory\",\n      label: \"Inventory\",\n      margin: \"normal\",\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(FormikSelectField, {\n      name: \"newPrice\",\n      label: \"NewPrice\",\n      margin: \"normal\",\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(FormikSelectField, {\n      name: \"oldPrice\",\n      label: \"OldPrice\",\n      margin: \"normal\",\n      fullWidth: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.Save,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"secondary\",\n      onClick: e => {\n        this.props.handleSubmit();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(SaveIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 30\n      }\n    }), \"Save\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: e => {\n        $('.productsFile').trigger('click');\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(ImageIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 34\n      }\n    }), \"Upload\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      style: {\n        display: 'none'\n      },\n      className: \"productsFile\",\n      onChange: this.uploadProductImage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 29\n      }\n    })))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  auth: state.auth,\n  admin: state.admin\n});\n\nconst mapDispatchToProps = dispatch => ({\n  addProduct: (product, token) => {\n    dispatch(AdminActions.addProduct(product, token));\n  },\n  updateProduct: (product, token) => {\n    dispatch(AdminActions.updateProduct(product, token));\n  },\n  getSingleProduct: (id, token) => {\n    dispatch(AdminActions.getSingleProduct(id, token));\n  },\n  uploadProductImage: (data, token, productId, userId) => {\n    dispatch(AdminActions.uploadImage(data, token, productId, userId));\n  }\n});\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(withFormik({\n  mapPropsToValues: props => ({\n    name: '',\n    supplier: '',\n    author: '',\n    publishing: '',\n    createdAt: '',\n    inventory: '',\n    newPrice: '',\n    oldPrice: '',\n    description: ''\n  }),\n  validationSchema: Yup.object().shape({\n    name: Yup.string().required(),\n    supplier: Yup.string().required(),\n    author: Yup.string().required(),\n    publishing: Yup.string().required(),\n    inventory: Yup.string().required(),\n    newPrice: Yup.string().required(),\n    description: Yup.string().required()\n  }),\n  handleSubmit: (values, {\n    setSubmitting,\n    props\n  }) => {\n    console.log(\"Saving\", props.addProduct);\n\n    if (props.match.params.view === 'edit') {\n      const product = { ...values,\n        id: props.match.params.id\n      };\n      props.updateProduct(product, props.auth.token);\n    } else {\n      props.addProduct(values, props.auth.token);\n    }\n  }\n})(withStyles(styles)(AddProduct))));","map":{"version":3,"sources":["/mnt/c/Users/Dep Trai/Projects/tueminhbookstore/src/components/Pages/Admin/AddProduct.js"],"names":["React","Component","connect","withStyles","AdminActions","Paper","withFormik","Field","Form","FormikTextField","FormikSelectField","Button","SaveIcon","ImageIcon","withRouter","Yup","API","ReactQuill","styles","theme","container","margin","spacing","display","flexDirection","width","productsImage","Save","marginBottom","formControl","leftSide","flex","height","padding","rightSide","AddProduct","uploadProductImage","e","data","FormData","append","target","files","Date","getTime","toString","name","props","auth","token","admin","product","id","user","userId","modules","toolbar","formats","componentDidUpdate","state","match","params","view","products","filter","p","title","values","length","history","push","dispatch","setValues","componentDidMount","getSingleProduct","render","classes","content","val","setFieldValue","handleSubmit","$","trigger","mapStateToProps","mapDispatchToProps","addProduct","updateProduct","productId","uploadImage","mapPropsToValues","supplier","author","publishing","createdAt","inventory","newPrice","oldPrice","description","validationSchema","object","shape","string","required","setSubmitting","console","log"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport * as AdminActions from '../../../store/actions/adminActions';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\nimport {withFormik, Field, Form} from 'formik';\r\nimport {FormikTextField, FormikSelectField} from 'formik-material-fields';\r\nimport Button from '@material-ui/core/Button';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport ImageIcon from '@material-ui/icons/Image';\r\n\r\nimport {withRouter} from 'react-router-dom';\r\nimport * as Yup from 'yup';\r\n\r\nimport API from '../../../utils/api';\r\n\r\nimport ReactQuill from 'react-quill';\r\nimport 'react-quill/dist/quill.snow.css';\r\n\r\n/* global $ */\r\nconst styles = theme => ({\r\n    container: {\r\n        margin: theme.spacing(3),\r\n        display: 'flex',\r\n        flexDirection: 'row wrap',\r\n        width: '100%'\r\n    },\r\n    productsImage: {\r\n        width: '100%'\r\n    },\r\n    Save: {\r\n        marginBottom: theme.spacing(2)\r\n    },\r\n    formControl: {\r\n        margin: theme.spacing()\r\n    },\r\n    leftSide: {\r\n        flex: 2,\r\n        height: '100%',\r\n        margin: theme.spacing(1),\r\n        padding: theme.spacing(3)\r\n    },\r\n    rightSide: {\r\n        flex: 1,\r\n        height: '100%',\r\n        margin: theme.spacing(1),\r\n        padding: theme.spacing(3)\r\n    }\r\n});\r\n\r\nclass AddProduct extends Component {\r\n\r\n    componentDidUpdate(props, state){\r\n        if(this.props.match.params.view === 'add' && this.props.admin.products.filter(p => p.title === this.props.values.title).length >0){\r\n            const product = this.props.admin.products.filter(p => p.title === this.props.values.title)[0];\r\n            this.props.history.push('/admin/products/edit/' + product.dispatch);\r\n        }\r\n\r\n        if(this.props.admin.product.id !== props.admin.product.id){\r\n            // when redux state changes product in admin reducer\r\n            this.props.setValues(this.props.admin.product);\r\n\r\n        }\r\n    }\r\n\r\n    uploadProductImage = (e) => {\r\n        const data = new FormData();\r\n        data.append('file', e.target.files[0], new Date().getTime().toString() + e.target.files[0].name);\r\n        this.props.uploadProductImage(data, this.props.auth.token, this.props.admin.product.id, this.props.auth.user.userId);\r\n    }\r\n\r\n    componentDidMount(props, state){\r\n        if(this.props.match.params.view === 'edit' && this.props.match.params.id){\r\n            this.props.getSingleProduct(this.props.match.params.id, this.props.auth.token);\r\n        }\r\n    }\r\n\r\n    modules= {\r\n        toolbar: [\r\n            ['bold', 'italic', 'underline', 'strike'],\r\n            [{'header': 1}, {'header': 2}],\r\n            [{'list': 'ordered'}, {'list': 'bullet'}],\r\n            [{'indent': '-1'}, {'indent': '+1'}],\r\n            [{'size': ['small', 'medium', 'large', 'huge']}],\r\n            [{'color': []}, {'background': []}],\r\n            ['image'],\r\n            ['clean']\r\n        ]    \r\n    }\r\n\r\n    formats = [\r\n        'header',\r\n        'bold', 'italic', 'underline', 'strike', 'blockquote', 'script',''\r\n    ]\r\n\r\n    render(){\r\n        const {classes} = this.props;\r\n\r\n        return (\r\n            <div>\r\n                \r\n                <Form className={classes.container}>\r\n                    <Paper className={classes.leftSide}>\r\n                        <FormikTextField\r\n                            name=\"name\"\r\n                            label=\"Name\"\r\n                            margin=\"normal\"\r\n                            fullWidth\r\n                        />\r\n                        <FormikTextField\r\n                            name=\"supplier\"\r\n                            label=\"Supplier\"\r\n                            margin=\"normal\"\r\n                        />\r\n                        <FormikTextField\r\n                            name=\"author\"\r\n                            label=\"Author\"\r\n                            margin=\"normal\"\r\n                            fullWidth\r\n                        />\r\n                        <FormikTextField\r\n                            name=\"publishing\"\r\n                            label=\"Publishing\"\r\n                            margin=\"normal\"\r\n                            fullWidth\r\n                        />\r\n                        <ReactQuill\r\n                            value={this.props.values.content}\r\n                            modules={this.modules}\r\n                            formats={this.formats}\r\n                            placeholder=\".....\"\r\n                            onChange={val => this.props.setFieldValue('description', val)}\r\n                        />\r\n                        \r\n                    </Paper>\r\n                    <Paper className={classes.rightSide}>\r\n                        <FormikSelectField \r\n                            name=\"inventory\"\r\n                            label=\"Inventory\"\r\n                            margin=\"normal\"\r\n                            fullWidth\r\n                        />\r\n                        <FormikSelectField \r\n                            name=\"newPrice\"\r\n                            label=\"NewPrice\"\r\n                            margin=\"normal\"\r\n                            fullWidth\r\n                        />\r\n                        <FormikSelectField \r\n                            name=\"oldPrice\"\r\n                            label=\"OldPrice\"\r\n                            margin=\"normal\"\r\n                            fullWidth\r\n                        />\r\n                        <div className={classes.Save}>\r\n                        <Button \r\n                            variant=\"contained\" \r\n                            color=\"secondary\"\r\n                            onClick={e => {\r\n                                this.props.handleSubmit();\r\n                            }}\r\n                            ><SaveIcon />Save</Button>\r\n                        </div>\r\n                        <div>\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={e => {\r\n                                    $('.productsFile').trigger('click');\r\n                                }}\r\n                                ><ImageIcon />Upload</Button>\r\n                            <input type=\"file\" style={{display: 'none'}} className=\"productsFile\" onChange={this.uploadProductImage}/>\r\n                            \r\n                        </div>\r\n                    </Paper>\r\n                </Form>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    auth: state.auth,\r\n    admin: state.admin\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    addProduct: (product,token) => {\r\n        dispatch(AdminActions.addProduct(product, token));\r\n    },\r\n    updateProduct: (product, token) => {\r\n        dispatch(AdminActions.updateProduct(product, token));\r\n    },\r\n    getSingleProduct: (id, token) => {\r\n        dispatch(AdminActions.getSingleProduct(id, token));\r\n    },\r\n    uploadProductImage: (data, token, productId, userId) => {\r\n        dispatch(AdminActions.uploadImage(data, token, productId, userId))\r\n    }\r\n});\r\n\r\nexport default withRouter(connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(withFormik({\r\n    mapPropsToValues: (props) => ({\r\n        name:  '',\r\n        supplier: '',\r\n        author: '',\r\n        publishing: '',\r\n        createdAt: '',\r\n        inventory: '',\r\n        newPrice: '',\r\n        oldPrice: '',\r\n        description: ''\r\n    }),\r\n    validationSchema: Yup.object().shape({\r\n        name: Yup.string().required(),\r\n        supplier: Yup.string().required(),\r\n        author: Yup.string().required(),\r\n        publishing: Yup.string().required(),\r\n        inventory: Yup.string().required(),\r\n        newPrice: Yup.string().required(),\r\n        description: Yup.string().required()\r\n    }),\r\n    handleSubmit: (values, {setSubmitting, props}) => {\r\n        console.log(\"Saving\", props.addProduct);\r\n        if(props.match.params.view === 'edit'){\r\n            const product = {\r\n                ...values,\r\n                id: props.match.params.id\r\n            }\r\n            props.updateProduct(product, props.auth.token);\r\n        }else{\r\n            props.addProduct(values, props.auth.token);\r\n        }\r\n    }\r\n})(withStyles(styles)(AddProduct))));"]},"metadata":{},"sourceType":"module"}